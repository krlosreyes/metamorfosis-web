---
interface Props {
    title: string;
    category?: string;
    readingTime?: number;
    publishedAt?: string;
    youtubeUrl?: string;
    thumbnailUrl?: string;
}

const { title, category, readingTime, publishedAt, youtubeUrl, thumbnailUrl } =
    Astro.props;

// Extract YouTube video ID if URL is provided
const getYouTubeThumbnail = (url: string) => {
    const videoId = url.match(
        /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/
    )?.[1];
    return videoId
        ? `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`
        : null;
};

const thumbnail =
    thumbnailUrl || (youtubeUrl ? getYouTubeThumbnail(youtubeUrl) : null);
---

<div
    class="relative bg-gradient-to-br from-brand-blue/5 via-brand-green/5 to-brand-blue/5 rounded-2xl overflow-hidden mb-8 shadow-xl"
>
    <div
        class="absolute inset-0 bg-gradient-to-br from-brand-blue/10 to-brand-green/10 opacity-50"
    >
    </div>

    <div class="relative z-10 p-8 md:p-12">
        <div class="max-w-4xl mx-auto">
            {/* Category & Reading Time */}
            <div class="flex flex-wrap items-center gap-3 mb-4">
                {
                    category && (
                        <span class="inline-flex items-center px-4 py-1.5 bg-brand-green text-white text-sm font-bold rounded-full shadow-md">
                            üè∑Ô∏è {category}
                        </span>
                    )
                }
                {
                    readingTime && (
                        <span class="inline-flex items-center px-4 py-1.5 bg-white/90 text-gray-700 text-sm font-semibold rounded-full shadow-sm">
                            ‚è±Ô∏è {readingTime} min de lectura
                        </span>
                    )
                }
                {
                    publishedAt && (
                        <span class="inline-flex items-center px-4 py-1.5 bg-white/90 text-gray-600 text-sm rounded-full shadow-sm">
                            üìÖ{" "}
                            {new Date(publishedAt).toLocaleDateString("es-ES", {
                                year: "numeric",
                                month: "long",
                                day: "numeric",
                            })}
                        </span>
                    )
                }
            </div>

            {/* Title */}
            <h1
                class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6 leading-tight"
            >
                {title}
            </h1>

            {/* YouTube Thumbnail */}
            {
                thumbnail && (
                    <div class="mt-8">
                        <a
                            href={youtubeUrl}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="block relative group"
                        >
                            <div class="relative rounded-2xl overflow-hidden shadow-2xl transition-transform duration-300 group-hover:scale-[1.02]">
                                <img
                                    src={thumbnail}
                                    alt={title}
                                    class="w-full h-auto object-cover"
                                />
                                {/* Play overlay */}
                                <div class="absolute inset-0 bg-black/40 flex items-center justify-center transition-all duration-300 group-hover:bg-black/30">
                                    <div class="w-20 h-20 bg-red-600 rounded-full flex items-center justify-center shadow-xl transition-transform duration-300 group-hover:scale-110">
                                        <svg
                                            class="w-10 h-10 text-white ml-1 flex-shrink-0"
                                            width="40"
                                            height="40"
                                            fill="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path d="M8 5v14l11-7z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <p class="text-center mt-4 text-brand-blue font-semibold group-hover:text-brand-green transition-colors">
                                üì∫ Ver video completo en YouTube
                            </p>
                        </a>
                    </div>
                )
            }
        </div>
    </div>
</div>
